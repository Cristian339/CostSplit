<app-header
  [tieneNotificaciones]="tieneNotificacionesPendientes"
  [numeroNotificaciones]="cantidadNotificaciones"
  [fotoUsuario]="fotoUsuario">
</app-header>

<ion-content class="home-content">
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div *ngIf="isLoading" class="loader-container">
    <ion-spinner name="crescent" color="secondary"></ion-spinner>
    <p>Cargando tus datos...</p>
  </div>

  <div *ngIf="!isLoading">
    <div class="welcome-container">
      <div class="welcome-text">
        <h1>Hola, {{userName}}</h1>
        <p>¿Qué quieres hacer hoy?</p>
      </div>
      <div class="summary-card">
        <div>
          <h2>Resumen</h2>
        </div>
        <ion-button fill="clear" (click)="verInformes()" color="tertiary">
          Ver informes
          <ion-icon name="chevron-forward-outline" slot="end"></ion-icon>
        </ion-button>
      </div>
    </div>

    <!-- NUEVO: Grid responsive para grupos y acciones -->
    <div class="main-responsive-grid">
      <div class="main-col main-col-grupos">
        <app-grupo-list></app-grupo-list>
      </div>
      <div class="main-col main-col-acciones">
        <section class="section-container acciones-section">
          <h2>Acciones rápidas</h2>
          <div class="actions-grid">
            <ion-card button (click)="nuevoGrupo()" class="action-card">
              <ion-icon name="people-outline" color="first"></ion-icon>
              <p>Nuevo grupo</p>
            </ion-card>
            <ion-card button [routerLink]="['/informes']" class="action-card">
              <ion-icon name="bar-chart-outline" color="secondary"></ion-icon>
              <p>Informes</p>
            </ion-card>
            <ion-card button [routerLink]="['/amigos']" class="action-card">
              <ion-icon name="person-outline" color="first"></ion-icon>
              <p>Mis amigos</p>
            </ion-card>
            <ion-card button [routerLink]="['/ayuda']" class="action-card" >
              <ion-icon name="help-circle-outline" color="secondary"></ion-icon>
              <p>Ayuda</p>
            </ion-card>
          </div>
        </section>
      </div>
    </div>

    <!-- Últimos gastos -->
    <section class="section-container" *ngIf="ultimosGastos.length > 0">
      <div class="section-header">
        <h2>Últimos gastos</h2>
      </div>
      <ion-card class="transparent-card">
        <ion-list lines="none">
          <ion-item *ngFor="let gasto of ultimosGastos">
            <div slot="start" class="gasto-icon">
              <ion-icon [name]="getIconoTipoGasto(gasto.tipoGasto)"></ion-icon>
            </div>
            <ion-label>
              <h3>{{gasto.descripcion}}</h3>
              <p>{{gasto.fecha | date:'dd MMM yyyy'}}</p>
            </ion-label>
            <ion-note slot="end" class="amount-note">{{gasto.montoTotal | currency:gasto.divisa}}</ion-note>
          </ion-item>
        </ion-list>
      </ion-card>
    </section>
  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button color="secondary" (click)="nuevoGrupo()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
